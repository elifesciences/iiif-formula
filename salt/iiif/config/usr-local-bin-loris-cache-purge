#!/bin/bash
set -e

# Aggressively delete the whole cache
LOG="/var/log/loris2/cache_clean.log"

IMG_CACHE_ROOT_DIR="{{ pillar.iiif.loris.storage }}/cache-resolver"
IMG_CACHE_DP_DIR="{{ pillar.iiif.loris.storage }}/cache-general"

log_message () {
    echo -ne "$(date +[%c]) " >> "$LOG"
    echo "$1" >> "$LOG"
}

rm -rf $IMG_CACHE_ROOT_DIR/*
rm -rf $IMG_CACHE_DP_DIR/*

log_message "Cache completely purged!" 
