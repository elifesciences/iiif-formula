elifePipeline {
    stage 'Checkout formula', {
        checkout scm
    }

    lock('iiif--ci') {
        stage 'Create IIIF server', {
            builderDeployRevision 'iiif--ci', params.revision
        }

        stage 'Test all articles .tif files', {
            sh './list-all-figures.sh | ./test-all-figures.sh'
        }
    }
}
